<ion-content>
  <div class="flex flex-col h-full">
    <app-header></app-header>
    <div class="flex flex-col grow w-full lg:max-w-290 py-5 lg:py-8 px-5 sm:px-8 mx-auto">
      <h1 class="pb-5 w-full text-center">
          Perfil
      </h1>
      <div class="flex flex-col lg:flex-row w-full">
        <div class="flex flex-col sm:flex-row lg:flex-col h-fit mb-4 items-center justify-between lg:justify-center w-full lg:w-1/3 p-4 lg:mr-4 bg-clear-bg  dark:bg-nightblue-60 rounded-2xl border border-solid border-white">
          <img class="rounded-full w-40 h-40 mr-4 lg:mr-0 object-cover border-2 border-solid border-nightblue-90  dark:border-clear" [src]="profilePictureSrc" alt="avatar">
          <div *ngIf="!editProfileActive" class="py-4 lg:block text-center">
            <div class="flex lg:flex-col">
              <h3 class="mr-2 lg:mr-0">
                {{firstName}}
              </h3>
              <h3>
                {{lastName}}
              </h3>
            </div>
            <div>Arquero {{category}}</div>
          </div>
          <div *ngIf="editProfileActive" class="py-4 w-full">
            <div class="pb-4 sm:px-2">
              <div class="pb-1 text-orange-100 text-xs">Nombre</div>
              <app-input placeholder="Nombre" type="text" [value]="firstName" [validate]="validateText"></app-input>
            </div>

            <div class="pb-4 sm:px-2">
              <div class="pb-1 text-orange-100 text-xs">Apellidos</div>
              <app-input placeholder="Apellidos" type="text" [value]="lastName" [validate]="validateText"></app-input>
            </div>

            <div class="pb-4 sm:px-2">
              <div class="pb-1 text-orange-100 text-xs">Categoría</div>
              <ion-list class="p-0 rounded-2xl">
                <ion-item class="bg-blue-50 text-nightblue border-0">
                  <ion-select [placeholder]="category || 'Selecciona categoría'" [value]="category" (ionChange)="changeCategory($event)">
                    <ion-select-option *ngFor="let category of categoryOptions" [value]="category">{{category}}</ion-select-option>
                  </ion-select>
                </ion-item>
              </ion-list>
            </div>
          </div>


          <ion-button *ngIf="editableProfile && !editProfileActive" (click)="editProfileActive = true" color="primary" size="small">
            Editar perfil
          </ion-button>
        </div>
        
        <div class="w-full lg:w-2/3 ">
          <div *ngIf="editProfileActive" class="p-4 mb-4 rounded-2xl border border-solid border-nightblue-60 dark:border-clear">
            <h2 class="pb-4 sm:px-2">
              Datos personales
            </h2>
            <div class="w-full grid grid-cols-1 sm:grid-cols-2">
              <div class="pb-4 sm:px-2">
                <div class="pb-1 text-orange-100 text-xs">Correo electrónico</div>
                <app-input placeholder="Email" type="email" [value]="email" [validate]="validateEmail"></app-input>
              </div>  
              <div class="pb-4 sm:px-2">
                <div class="pb-1 text-orange-100 text-xs">Teléfono</div>
                <app-input placeholder="Teléfono" type="text" [value]="telephone" [validate]="validatePhone"></app-input>
              </div>        
            </div>
            <div class="w-full flex justify-center">
              <ion-button color="primary" size="small" (click)="updateProfile()">
                Guardar cambios
              </ion-button>
            </div>
          </div>
          <div class="p-4 rounded-2xl border border-solid border-nightblue-60 dark:border-clear">
            <h2 class="pb-4 sm:px-2">
              Competiciones
            </h2>
            <div class="w-full grid grid-cols-1 sm:grid-cols-2">
              <div *ngFor="let competition of competitionArray; let i=index" class="pb-4 sm:px-2">
                <app-competition-card *ngIf="i < 6" [name]="competition.name" [date]="competition.date" [position]="competition.position"
                [points]="competition.points" [category]="competition.category" [distance]="competition.distance" 
                [type]="competition.type"></app-competition-card>
              </div>        
            </div>
            <div class="w-full flex justify-center">
              <ion-button *ngIf="competitionArray.length > 6" color="primary" size="small" routerLink="">
                Ver más
              </ion-button>
            </div>
          </div>
          <div class="mt-4 p-4 rounded-2xl border border-solid border-nightblue-60 dark:border-clear">
            <h2 class="pb-4">
              Plusmarcas
            </h2>
            <div class="w-full">
              <div *ngFor="let record of recordsArray; let i=index" class="pb-4 w-full">
                <app-record-card *ngIf="i < 6" [recordName]="record.recordName" [distance]="record.distance" [type]="record.type" 
                [date]="record.date" [points]="record.points"></app-record-card>
              </div>        
            </div>
            <div class="w-full flex justify-center">
              <ion-button *ngIf="recordsArray.length > 6" color="primary" size="small" routerLink="">
                Ver más
              </ion-button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <app-footer></app-footer>
  </div>
</ion-content>
